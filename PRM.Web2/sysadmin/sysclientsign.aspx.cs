using System;
using System.Data;
using System.Configuration;
using System.Collections;
using System.Web;
using System.Web.Security;
using System.Web.Services;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Web.UI.HtmlControls;


public partial class sysclientsign : BasePage
{
    protected void Page_Load(object sender, EventArgs e)
    {
    }
    protected void btnSubmit_Click(object sender, EventArgs e)
    {
        //Put user code to initialize the page here
        Topaz.SigPlusNET sigObj = new Topaz.SigPlusNET();

        sigObj.SetSigCompressionMode(1);
        //Now, get sigstring from client
        //Sigstring can be stored in a database if 
        //a biometric signature is desired rather than an image

        //Image String for testing without device. Will create image with words "Test Image".
        string TestString = "0C0022000C019000FF0000000001FF02FF0300050006010701080309030A030A040B040C050B040A040B0509030A040903080208020702060106000501030002000100010000000000001D00A400AA0000FF01FF03FE04FE07FD09FD0BFD0CFE0FFD0FFD11FD11FC11FC12FB11FC10FB10FB0FFC0EFC0CFC0BFD09FD05FF03FF010000000000000034008B011E01000002010200030103FF03FF04FF03FD04FD04FC04FB04FA03FB03FA03FB01FBFFFBFFFDFEFEFDFFFC01FC01FB03FA04FB04FA06FC07FC07FC08FE07FE080006000602040205030403030404040305030502060205010600050003000200000000000000000023000F02E700FF00FF01FE02FD02FD02FD03FE03FE03000301040304030405040603070407040603060304030303020301020003FE02FE02FD02FC02FC00FD01FF0000000000000000001900AD027F00FF020004FF07FE0AFF0BFF0BFF0CFF0D000D000C010D020B020C020A010A02090108000700040003000100000000000012007502EF0001FF04FE05FD09FB09FC0BFB0BFC0BFC0CFC0BFC08FE06FE04FF010000000000000019008103D00000000002000300060107010801080109020802070307030702050306020502040103020201010000010100000000000005006E03900000000000000000003E00F1032801FF0000FFFF00FEFEFEFDFFFCFFF9FFF800F601F501F503F403F504F704F904FB04FE040003020404030503070307030802070207010601060204010301020102020003FF03FE04FC04FC04FB04FC03FD04FD03FF02010302020301050206020601060205020403040304030202020100010100000000000000003400D704E90000FF00FF00FF00FD00FEFFFDFFFDFFFCFFFDFEFCFEFCFEFDFDFEFCFFFC00FC01FB04FB04FA06FA07FC07FD05FE050004020303020400050005FE06FE06FD06FE07FE06000501040304030304020402050205010502040103010200010101000000000000000034006805E50000FF01FE01FE02FC01FC01FB00FB00FB00FBFFFBFEFCFDFDFDFEFD00FC02FB04FB06FB07FC08FD08FE06FF0601040304030204030602050207020704060505070409030A020A000B000BFF0BFE0BFF09FD09FE07FD05FD03FE02FE01000100000000000000002600A505210101FF03FE05FE06FC07FB06F907F906F705F605F503F702F801FAFFFDFE00FC03FB05FA07FB09FB09FD09FF090107030705060705080508030A020B020801060103000000000000000000";
        if (hdnSigData.Value == "") { hdnSigData.Value = TestString; }

        sigObj.SetSigString(hdnSigData.Value);

        if (sigObj.NumberOfTabletPoints() > 0)
        {
            sigObj.SetImageFileFormat(0);
            sigObj.SetImageXSize(500);
            sigObj.SetImageYSize(150);
            sigObj.SetImagePenWidth(8);
            sigObj.SetJustifyX(5);
            sigObj.SetJustifyY(5);
            sigObj.SetJustifyMode(5);
            System.Drawing.Image img = sigObj.GetSigImage();
            String path;
            //path = System.AppDomain.CurrentDomain.BaseDirectory & "mySig.bmp"
            path = "C:\\mySig.png";
            img.Save(path, System.Drawing.Imaging.ImageFormat.Png);
            Response.Write("Image saved successfully to " + path);
        }
        else
        {
            //signature has not been returned successfully!
        }
    }
}
